
# R-INN 论文复现项目 README​
## 项目概述​
本仓库用于复现论文《R-INN: An Efficient Reversible Design Model for Microwave Circuit Design》中的可逆神经网络（Real NVP-based Invertible Neural Network）模型。该模型将可逆神经网络应用于微波电路设计，通过学习电路参数与电磁响应之间的映射关系，实现高效的电路设计与优化。​
复现目标包括：​
实现论文提出的 R-INN 网络结构​
复现关键实验结果（如 NMSE 误差、S 参数拟合曲线）​
建立可复用的微波电路设计深度学习工作流


# 环境配置&项目页面


<sup> https://www.notion.so/276a5242543380d38f58f1346d75a53d?source=copy_link </sup>

<sup> https://www.notion.so/R-INN-271a52425433805790a7c71d2da181dd </sup>

## 最新成果

### 1. 理想滤波器图像生成与变换

#### 生成功能
- 实现了四阶波导滤波器的理想S11响应生成
- 支持自定义目标S11值（默认-26dB）
- 自动搜索最佳RP参数以满足目标要求

#### 变换功能
- **相反数变换**：对Re和Im的每个值取相反数
- **中心频率对称变换**：将Re和Im沿着中心频率做对称

### 2. R-INN模型训练与应用

#### 模型训练
- 使用所有501组训练数据进行训练
- 模型配置：
  - 隐藏维度：56
  - 块数量：4
  - 阶段数量：2
  - 批次大小：16
  - 学习率：0.000659
- 训练结果：
  - 验证损失：0.0147
  - 逆向预测准确率：0.9785

#### 模型应用
- 对原始理想数据、相反数变换数据和中心频率对称变换数据应用R-INN模型
- 执行逆向预测，重建几何参数
- 执行正向预测，生成Re/Im曲线

### 3. 相似性分析

#### 关键发现
- **OOD问题**：理想滤波器响应与训练数据存在显著差异，属于Out-of-Distribution数据
- **有限覆盖**：训练数据集未能充分覆盖理想滤波器响应空间
- **相似性分析**：找到与理想S11最相近的10个训练样本，但仍存在明显偏差

#### 可视化结果
- `result_similarity_analysis/s11_comparison.png`：理想S11与最相似训练样本的对比
- `result_similarity_analysis/re_comparison.png`：理想Re(S11)与最相似训练样本的对比
- `result_similarity_analysis/im_comparison.png`：理想Im(S11)与最相似训练样本的对比

### 4. 技术实现

#### 新增文件
- `filter_rinn_transformed.py`：对变换后的数据应用R-INN模型
- `find_similar_data.py`：寻找与理想数据最相似的训练样本

#### 改进文件
- `filter_ideal/core.py`：添加相反数变换和中心频率对称变换功能
- `trains11RINN.py`：修改为使用所有501组数据进行训练

### 5. 结论与展望

#### 结论
- 成功实现了R-INN模型的训练和应用
- 验证了理想滤波器响应的OOD特性
- 证明了训练数据覆盖不足的问题

#### 未来工作
- **扩展训练数据集**：增加更多样的滤波器响应，覆盖理想响应空间
- **改进模型架构**：探索更深层或更复杂的网络结构
- **数据增强**：实现数据增强技术，提高模型泛化能力
- **迁移学习**：研究从相关滤波器类型的迁移学习
